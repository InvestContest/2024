####[Что такое шаг цены?](#2.1)  
####[Отличие лотов и количества инструментов](#2.2)  
####[Цены облигаций и фьючерсов](#2.3)  
####[Формулы расчета реальной стоимости инструментов в валюте ](#2.4)  
####[Какие интервалы доступны при запросе исторических свечей?](#2.5)  
####[Как одним запросом получить последние цены по нескольким инструментам?](#2.6)  
####[Как подписаться на разные типы данных в рамках stream-соединения сервиса котировок?](#2.7)  
####[Внебиржевые инструменты в TINKOFF INVEST API](#2.8)  
####[Какие данные отливаются в стриминг стаканов?](#2.9)  
####[Торговля бумагами Тинькофф через TINKOFF INVEST API](#2.10)  
####[Валюты в TINKOFF INVEST API](#2.11)  
####[Почему отличаются исторические цены в TINKOFF INVEST API и других источниках?](#2.12)  
####[Как получить исторические рыночные данные?](#2.13)  
####[Какое максимальное количество запросов на подписку в MarketDataStream?](#2.14)  
####[Как узнать дату, с которой можно получить свечи по инструменту?](#2.15)  
####[Как узнать доступности торгов инструментом через API?](#2.16)  
###[Какой идентификатор инструмента использовать для получения данных в сервисе котировок?](#2.17)  

###Что такое шаг цены? <a id="2.1"></a>

Шаг цены — это минимальное изменение цены определенного инструмента.

####Пример

Шаг цены для инструмента = `0.1`, а последняя цена = `10.5` — это означает, что заявка может быть выставлена по одной из следующих цен:

* 10.4
* 10.5
* 10.6

Цена `10.55` будет некорректной и заявка не будет выставлена.

```scala
def isValidPrice(price: BigDecimal, increment: BigDecimal): Boolean = {
    price % increment == 0
}

isValidPrice(10.1, 0.1) // true
isValidPrice(10.16, 0.1) // false
```

###Отличие лотов и количества инструментов <a id="2.2"></a>

При работе с сервисом TINKOFF INVEST API следует обращать особое внимание на различия понятий
лот и количество ценных бумаг. Все цены в [сервисе котировок](/investAPI/head-marketdata/) предоставляются
за одну ценную бумагу. Данное правило касается методов [GetLastPrice](/investAPI/marketdata#getlastprices), 
[GetCandles](/investAPI/marketdata#getcandles), а так же подписки на эти данные в рамках [stream-соединений](/investAPI/marketdata#marketdatastreamservice)
данного сервиса. 

При получении данных по стакану или сделкам объём этих сделок отображается в лотах. Т.е. параметр quantity
метода [GetOrderBook](/investAPI/marketdata#getorderbook) и пакета [trade](/investAPI/marketdata#trade) в рамках
[stream-соединений](/investAPI/marketdata#marketdatastreamservice) сервиса отображается в **лотах**

###Цены облигаций и фьючерсов <a id="2.3"></a>

Цены облигаций и фьючерсов в TINKOFF INVEST API предоставляются в пунктах. Методика расчёта стоимости 
лота в валюте отличается в зависимости от типа биржевого инструмента. 

##Формулы расчета реальной стоимости инструментов в валюте <a id="2.4"></a>

* **price** — текущая котировка ценной бумаги;
* **nominal** — номинал облигации;
* **min_price_increment** — шаг цены;
* **min_price_increment_amount** — стоимость шага цены;
* **lot** - лотность инструмента.

###Акции 

> **price** * **lot**

###Облигации 

Пункты цены для котировок облигаций представляют собой проценты номинала облигации. Для пересчёта пунктов
в валюту можно воспользоваться формулой:

> **price** / 100 * **nominal**


###Валюта 

> **price** * **lot** / **nominal**

**Важно!** При торговле валютой необходимо учитывать, что такие валюты как Иена, Армянский драм и Тенге имеют nominal = 100

<a name="futures"></a>
###Фьючерсы

Стоимость фьючерсов так же предоставляется в пунктах, для пересчёта можно воспользоваться формулой:

> **price** / **min_price_increment** * **min_price_increment_amount**

Так же при работе с фьючерсами важно учитывать размер гарантийного обеспечения. Узнать эти параметры фьючерсов
можно при помощи метода: [getFuturesMargin](/investAPI/instruments#getfuturesmargin). Подробнее про срочный
рынок читайте [тут](https://help.tinkoff.ru/forts/)

###Какие интервалы доступны при запросе исторических свечей? <a id="2.5"></a> 

Метод [GetCandles](/investAPI/marketdata#getcandles) позволяет получать исторические свечи разных 
таймфреймов. Существует ограничение на максимальный и минимальный период запроса для каждого интервала 
свечей: 

|Запрошенный интервал свечей|Допустимый период запроса|
|:---|---:|
| CANDLE_INTERVAL_UNSPECIFIED | Интервал не определён. |
| CANDLE_INTERVAL_1_MIN | от 1 минуты до 1 дня. |
| CANDLE_INTERVAL_5_MIN  | от 5 минут до 1 дня. |
| CANDLE_INTERVAL_15_MIN | от 15 минут до 1 дня. |
| CANDLE_INTERVAL_HOUR | от 1 часа до 1 недели. |
| CANDLE_INTERVAL_DAY | от 1 дня до 1 года. |
| CANDLE_INTERVAL_2_MIN | от 2 минут до 1 дня. |
| CANDLE_INTERVAL_3_MIN | от 3 минут до 1 дня. |
| CANDLE_INTERVAL_10_MIN | от 10 минут до 1 дня. |
| CANDLE_INTERVAL_30_MIN | от 30 минут до 2 дней. |
| CANDLE_INTERVAL_2_HOUR  | от 2 часов до 1 месяца. |
| CANDLE_INTERVAL_4_HOUR | от 4 часов до 1 месяца. |
| CANDLE_INTERVAL_WEEK | от 1 недели до 2 лет. |
| CANDLE_INTERVAL_MONTH | от 1 месяца до 10 лет. |

**Важно!** При запросе дневных свечей CANDLE_INTERVAL_DAY время, переданное в поля from и to игнорируется,
Т.е. при запросе дневной свечи по интервалу с 12:00 01.01.2021 по 07:00 02.01.2021 вернётся две дневных 
свечи за 01.01.2021 и за 02.01.2021

**Важно!**  При попытке получить данные с временным интервалом меньше временного интервала данного таймфрейма, ответом метода будет возвращен пустой массив. Например, если интервал при запросе дневных свечей (CANDLE_INTERVAL_DAY) инструмента будет 1 час.

###Как одним запросом получить последние цены по нескольким инструментам? <a id="2.6"></a>

Для получения цен последних сделок по массиву инструментов можно методом 
[GetLastPrices](/investAPI/marketdata#getlastprices). Во входные параметры метода можно передать массив
идентификаторов инструментов.

###Как подписаться на разные типы данных в рамках stream-соединения сервиса котировок? <a id="2.7"></a>

Bi-directional stream Сервиса котировок поддерживает одновременную подписку на разные типы данных (свечи,
стаканы, сделки и т.п.) в рамках одного соединения. Для этого следует последовательно отправить пакеты
подписки на разные данные. Т.е. отдельно реализуется подписка на свечи, отдельно на стаканы и т.п. 
Подробнее можно узнать в примерах выбранного вами SDK.

###Внебиржевые инструменты в TINKOFF INVEST API <a id="2.8"></a>

В данный момент TINKOFF INVEST API предполагает работу только с биржевыми инструментами.

###Какие данные отливаются в стриминг стаканов? <a id="2.9"></a>

Пока только биржевые. Внебиржевые стаканы, например, TRRE, не транслируются в режиме стриминга.

###Торговля бумагами Тинькофф через TINKOFF INVEST API<a id="2.10"></a>

Из-за огромного количества скальперских сделок мы закрыли торговлю БПИФ от УК "Тинькофф Капитал" в TINKOFF INVEST API. 
Список бумаг смотрите [здесь](https://russianinvestments.github.io/invest-openapi/).

###Валюты в TINKOFF INVEST API<a id="2.11"></a>

Получить список доступных валют можно при помощи метода [getInstruments/currencies](/investAPI/instruments#currencies).

Обратите внимание, что лотность валют ограничена лотностью, которая предоставляет биржа. Например, операции
с Евро и Долларами возможны только на количества кратные 1000.

###Почему отличаются исторические цены в TINKOFF INVEST API и других источниках?<a id="2.12"></a>

Исторические данные [Тинькофф Инвестиций](https://www.tinkoff.ru/invest/) могут отличаться от данных,
которые предоставляют другие сервисы. Связано это может быть как с различными источниками первичных данных,
так и с различными алгоритмами их обработки и агрегации. 

###Как получить исторические рыночные данные?<a id="2.13"></a>

Исторические рыночные данные можно загрузить в виде архива используя метод [Загрузка исторических рыночных данных в виде архива](/investAPI/get_history/).


###Какое максимальное количество запросов на подписку в [MarketDataStream](/investAPI/marketdata/#marketdatastream)?<a id="2.14"></a>

Для всех типов подписок в [методе](/investAPI/marketdata/#marketdatastream) установлены ограничения максимального количества запросов на подписку.
Если количество запросов за минуту превысит 100, то для всех элементов будет установлен статус [SUBSCRIPTION_STATUS_TOO_MANY_REQUESTS](/investAPI/marketdata/#subscriptionstatus).

Максимальное количество запросов в минуту = 100.

###Как узнать дату, с которой можно получить свечи по инструменту?<a id="2.15"></a>

Для того что бы понять с какой даты запрашивать свечи по инструменту в [Сервис инструментов](/investAPI/head-instruments/) TINKOFF INVEST API добавлены параметры `first_1min_candle_date` и `first_1day_candle_date`.
Данные параметры возвращаются в методах получения информации об инструментах. Параметр `first_1min_candle_date` возвращает дату первой минутной свечи, а `first_1day_candle_date` дату первой дневной свечи.

###Как узнать доступности торгов инструментом через API?<a id="2.16"></a>

Узнать доступность торгов инструментом можно по параметру `api_trade_available_flag` в методе [getTradingStatus](/investAPI/marketdata/#gettradingstatus) или [FindInstrument](/investAPI/instruments/#findinstrument).


###Какой идентификатор инструмента использовать для получения данных в сервисе котировок?<a id="2.17"></a>

Все методы сервиса котировок принимают на вход `instrumentId` - параметр, в который можно передать значение **instrument_uid** *или* **FIGI**.
Получить более подробную информацию можно на странице [об идентификаторах инструментов](/investAPI/faq_identification/).